<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ğŸ¦„ Unicorn Spelling Journey</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap');

    /* â”€â”€ Base â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Nunito', 'Comic Sans MS', cursive;
      background: linear-gradient(160deg, #ffe4f0 0%, #ffd6f0 40%, #f9c6ff 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 16px 12px 48px;
    }

    /* â”€â”€ Header â”€â”€ */
    h1 {
      font-size: 2rem;
      font-weight: 900;
      color: #c0006a;
      text-shadow: 2px 2px 0 #fff, 4px 4px 0 #f9a8d4;
      margin-bottom: 4px;
      text-align: center;
    }

    #stars-bar {
      font-size: 1.1rem;
      color: #e05ca0;
      margin-bottom: 10px;
    }

    /* â”€â”€ Journey road â”€â”€ */
    #journey {
      display: flex;
      align-items: center;
      gap: 0;
      margin-bottom: 14px;
      flex-wrap: nowrap;
      overflow-x: auto;
      padding: 6px 4px;
      max-width: 560px;
      width: 100%;
    }

    .road-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex-shrink: 0;
    }

    .road-dot {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #f9c6ff;
      border: 3px solid #e991cf;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.65rem;
      font-weight: 900;
      color: #c0006a;
      transition: background 0.4s, border-color 0.4s;
      cursor: default;
    }

    .road-dot.done   { background: #f472b6; border-color: #be185d; color: #fff; }
    .road-dot.active { background: #fff; border-color: #c0006a; color: #c0006a; transform: scale(1.25); box-shadow: 0 0 0 4px #f9a8d440; }

    .road-line {
      width: 20px;
      height: 4px;
      background: #f0abcf;
      border-radius: 2px;
      flex-shrink: 0;
    }

    .road-unicorn { font-size: 1.6rem; flex-shrink: 0; filter: grayscale(0.6); transition: filter 0.4s; }
    .road-unicorn.reached { filter: none; animation: unicornBounce 0.6s ease infinite alternate; }

    @keyframes unicornBounce {
      from { transform: translateY(0) rotate(-5deg); }
      to   { transform: translateY(-6px) rotate(5deg); }
    }

    /* â”€â”€ Level label â”€â”€ */
    #level-label {
      font-size: 0.9rem;
      color: #be185d;
      margin-bottom: 12px;
      font-weight: 700;
    }

    /* â”€â”€ Game card â”€â”€ */
    #game-card {
      background: #fff;
      border-radius: 28px;
      padding: 26px 28px 22px;
      box-shadow: 0 8px 32px #f472b640;
      max-width: 520px;
      width: 100%;
      text-align: center;
      border: 3px solid #f9a8d4;
      position: relative;
    }

    /* â”€â”€ Hint image / emoji â”€â”€ */
    #word-hint {
      font-size: 4rem;
      margin-bottom: 6px;
      animation: popIn 0.4s ease;
    }

    #word-clue {
      font-size: 0.95rem;
      color: #be185d;
      margin-bottom: 14px;
      font-style: italic;
    }

    /* â”€â”€ Word display â”€â”€ */
    #word-display {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .letter-box {
      width: 46px;
      height: 52px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      font-weight: 900;
      border: 3px solid #f9a8d4;
      background: #fff0f8;
      color: #c0006a;
      transition: transform 0.2s;
    }

    .letter-box.blank {
      border: 3px dashed #f472b6;
      background: #fff;
      color: transparent;
      font-size: 1rem;
      position: relative;
    }

    .letter-box.blank::after {
      content: '?';
      position: absolute;
      color: #f9a8d4;
      font-size: 1.6rem;
      font-weight: 900;
    }

    .letter-box.correct-reveal {
      background: #fce7f3;
      border-color: #ec4899;
      animation: popIn 0.35s ease;
    }

    .letter-box.wrong-shake { animation: shake 0.4s ease; }

    @keyframes popIn {
      from { transform: scale(0.6); opacity: 0; }
      to   { transform: scale(1);   opacity: 1; }
    }

    @keyframes shake {
      0%,100% { transform: translateX(0); }
      25%     { transform: translateX(-8px) rotate(-3deg); }
      75%     { transform: translateX(8px)  rotate(3deg); }
    }

    /* â”€â”€ Letter choices â”€â”€ */
    #choices {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .choice-btn {
      width: 58px;
      height: 58px;
      border-radius: 50%;
      font-size: 1.7rem;
      font-weight: 900;
      font-family: inherit;
      border: 3px solid #f9a8d4;
      background: #fff0f8;
      color: #c0006a;
      cursor: pointer;
      transition: transform 0.15s, background 0.15s, border-color 0.15s;
    }

    .choice-btn:hover   { transform: scale(1.18); background: #fce7f3; }
    .choice-btn.correct { background: #fbcfe8; border-color: #db2777; animation: bounce 0.4s ease; }
    .choice-btn.wrong   { background: #ffe4e6; border-color: #f43f5e; animation: shake 0.4s ease; }
    .choice-btn:disabled { opacity: 0.5; cursor: default; transform: none; }

    @keyframes bounce {
      0%,100% { transform: scale(1); }
      50%     { transform: scale(1.3); }
    }

    /* â”€â”€ Door / gate â”€â”€ */
    #door-wrap {
      margin: 0 auto 16px;
      position: relative;
      width: 110px;
      height: 130px;
    }

    .door-frame {
      position: absolute;
      inset: 0;
      border: 5px solid #f472b6;
      border-radius: 55px 55px 6px 6px;
      background: #fff0f8;
      overflow: hidden;
    }

    .door-panel {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, #fce7f3, #fbcfe8);
      border-radius: 52px 52px 4px 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.6rem;
      transform-origin: left center;
      transition: transform 0.7s cubic-bezier(0.4,0,0.2,1);
    }

    .door-panel.open { transform: perspective(400px) rotateY(-110deg); }

    .door-knob {
      position: absolute;
      right: 14px;
      top: 50%;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #f472b6;
      border: 2px solid #be185d;
    }

    /* â”€â”€ Feedback â”€â”€ */
    #feedback {
      font-size: 1.2rem;
      font-weight: 700;
      min-height: 32px;
      margin-bottom: 8px;
    }

    #feedback.good { color: #be185d; }
    #feedback.bad  { color: #f43f5e; }

    /* â”€â”€ Next btn â”€â”€ */
    #next-btn {
      display: none;
      padding: 11px 30px;
      font-size: 1.1rem;
      font-family: inherit;
      font-weight: 900;
      background: linear-gradient(135deg, #f472b6, #ec4899);
      border: none;
      border-radius: 40px;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 4px 14px #f472b660;
      transition: transform 0.15s;
    }

    #next-btn:hover { transform: scale(1.08); }

    /* â”€â”€ Level complete screen â”€â”€ */
    #level-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      text-align: center;
    }

    #level-screen .big-emoji { font-size: 3.8rem; animation: unicornBounce 0.7s ease infinite alternate; }
    #level-screen h2 { font-size: 1.7rem; color: #be185d; text-shadow: 1px 1px 0 #fce7f3; }
    #level-screen p  { font-size: 1rem; color: #9d174d; }

    #next-level-btn {
      padding: 12px 30px;
      font-size: 1.1rem;
      font-family: inherit;
      font-weight: 900;
      background: linear-gradient(135deg, #a855f7, #ec4899);
      border: none;
      border-radius: 40px;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 4px 14px #a855f740;
      transition: transform 0.15s;
    }

    #next-level-btn:hover { transform: scale(1.08); }

    /* â”€â”€ Win screen â”€â”€ */
    #win-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 14px;
      text-align: center;
    }

    #win-screen .unicorn-big {
      font-size: 6rem;
      animation: unicornBounce 0.6s ease infinite alternate;
    }

    #win-screen h2 { font-size: 2rem; color: #be185d; text-shadow: 2px 2px 0 #fce7f3; }
    #win-screen p  { font-size: 1.05rem; color: #9d174d; }

    .confetti-row { font-size: 1.6rem; letter-spacing: 6px; animation: fadeSlide 0.5s ease; }

    @keyframes fadeSlide {
      from { opacity: 0; transform: translateY(-10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    #play-again-btn {
      padding: 13px 32px;
      font-size: 1.1rem;
      font-family: inherit;
      font-weight: 900;
      background: linear-gradient(135deg, #ec4899, #f472b6);
      border: none;
      border-radius: 40px;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 4px 14px #ec489960;
      transition: transform 0.15s;
    }

    #play-again-btn:hover { transform: scale(1.08); }

    /* â”€â”€ Mobile â”€â”€ */
    @media (max-width: 480px) {
      body { padding: 10px 8px 36px; }
      h1 { font-size: 1.5rem; }
      #game-card { padding: 18px 14px 16px; border-radius: 20px; }
      #word-hint { font-size: 3rem; }
      .letter-box { width: 38px; height: 44px; font-size: 1.4rem; border-radius: 10px; }
      .choice-btn { width: 50px; height: 50px; font-size: 1.4rem; }
      #door-wrap { width: 90px; height: 108px; }
      #win-screen .unicorn-big { font-size: 4.5rem; }
    }
  </style>
</head>
<body>

  <h1>ğŸ¦„ Unicorn Spelling Journey</h1>
  <div id="stars-bar">â­ <span id="star-count">0</span> stars</div>

  <!-- Road journey -->
  <div id="journey"></div>
  <div id="level-label"></div>

  <div id="game-card">

    <!-- Game view -->
    <div id="game-view">
      <div id="word-hint"></div>
      <div id="word-clue"></div>
      <div id="word-display"></div>

      <!-- Door -->
      <div id="door-wrap">
        <div class="door-frame">
          <div class="door-panel" id="door-panel">ğŸŒ¸</div>
          <div class="door-knob"></div>
        </div>
      </div>

      <!-- Letter choices -->
      <div id="choices"></div>

      <div id="feedback"></div>
      <button id="next-btn">Next â¡ï¸</button>
    </div>

    <!-- Level complete -->
    <div id="level-screen">
      <div class="big-emoji" id="lc-emoji"></div>
      <h2 id="lc-title"></h2>
      <p  id="lc-msg"></p>
      <button id="next-level-btn">Next Level â¡ï¸</button>
    </div>

    <!-- Win! -->
    <div id="win-screen">
      <div class="unicorn-big">ğŸ¦„</div>
      <div class="confetti-row">ğŸ€ğŸŒ¸ğŸ’–ğŸŒˆâœ¨ğŸ€</div>
      <h2>You found the Unicorn!</h2>
      <p id="win-msg"></p>
      <button id="play-again-btn">Play Again ğŸ€</button>
    </div>

  </div>

  <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SOUND
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    let _ctx = null;
    const ctx = () => { if (!_ctx) _ctx = new AudioCtx(); return _ctx; };

    function tone(freq, type, dur, vol = 0.25, delay = 0) {
      const c = ctx(), o = c.createOscillator(), g = c.createGain();
      o.connect(g); g.connect(c.destination);
      o.type = type;
      o.frequency.setValueAtTime(freq, c.currentTime + delay);
      g.gain.setValueAtTime(vol, c.currentTime + delay);
      g.gain.exponentialRampToValueAtTime(0.001, c.currentTime + delay + dur);
      o.start(c.currentTime + delay);
      o.stop(c.currentTime + delay + dur);
    }

    const sndCorrect  = () => { tone(600,'sine',0.1,0.22,0); tone(750,'sine',0.1,0.22,0.1); tone(900,'sine',0.15,0.22,0.2); };
    const sndWrong    = () => { tone(250,'sawtooth',0.15,0.2,0); tone(200,'sawtooth',0.15,0.18,0.14); };
    const sndDoor     = () => [440,554,659,880].forEach((f,i) => tone(f,'sine',0.18,0.22,i*0.08));
    const sndLevelUp  = () => [330,415,523,659,784,1047].forEach((f,i) => tone(f,'triangle',0.16,0.24,i*0.09));
    const sndWin      = () => [523,659,784,1047,784,880,1047,1319].forEach((f,i) => tone(f,'sine',0.2,0.26,i*0.11));

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // LEVELS  â€” 10 levels Ã— 3 words each, ascending difficulty
    // Each word: { word, missing (0-based index), emoji, clue }
    // Level 1â€“2:  CVC words (3-letter), 1 missing vowel
    // Level 3â€“4:  4-letter words, 1 missing
    // Level 5â€“6:  4â€“5 letter words, trickier positions
    // Level 7â€“8:  5-letter words
    // Level 9â€“10: 5â€“6 letter words, consonant clusters
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const LEVELS = [
      { name: 'Level 1 â€“ Tiny Words ğŸŒ¸', emoji: 'ğŸŒ¸', words: [
        { word:'CAT', missing:1, emoji:'ğŸ±', clue:'A fluffy pet that says meow!' },
        { word:'DOG', missing:1, emoji:'ğŸ¶', clue:'A pet that loves to fetch!' },
        { word:'SUN', missing:1, emoji:'â˜€ï¸', clue:'It shines bright in the sky!' },
      ]},
      { name: 'Level 2 â€“ Animal Friends ğŸ¾', emoji: 'ğŸ¾', words: [
        { word:'HEN', missing:1, emoji:'ğŸ”', clue:'A farm bird that lays eggs!' },
        { word:'PIG', missing:1, emoji:'ğŸ·', clue:'Oink oink! Pink and round!' },
        { word:'BEE', missing:2, emoji:'ğŸ', clue:'It makes honey and goes buzz!' },
      ]},
      { name: 'Level 3 â€“ Sweet Things ğŸ­', emoji: 'ğŸ­', words: [
        { word:'CAKE', missing:1, emoji:'ğŸ‚', clue:'Yummy on your birthday!' },
        { word:'MILK', missing:2, emoji:'ğŸ¥›', clue:'White drink from a cow!' },
        { word:'FISH', missing:2, emoji:'ğŸ ', clue:'It swims in the sea!' },
      ]},
      { name: 'Level 4 â€“ Around You ğŸ¡', emoji: 'ğŸ¡', words: [
        { word:'BOOK', missing:2, emoji:'ğŸ“š', clue:'You read stories in this!' },
        { word:'DOOR', missing:2, emoji:'ğŸšª', clue:'You open it to go inside!' },
        { word:'FROG', missing:2, emoji:'ğŸ¸', clue:'Green and loves to jump!' },
      ]},
      { name: 'Level 5 â€“ Colours & Fun ğŸ¨', emoji: 'ğŸ¨', words: [
        { word:'PINK',  missing:1, emoji:'ğŸŒ¸', clue:'The prettiest colour!' },
        { word:'BEAR',  missing:1, emoji:'ğŸ§¸', clue:'A fluffy cuddly toy!' },
        { word:'STAR',  missing:2, emoji:'â­', clue:'It twinkles at night!' },
      ]},
      { name: 'Level 6 â€“ Nature Walk ğŸŒ¿', emoji: 'ğŸŒ¿', words: [
        { word:'CLOUD', missing:2, emoji:'â˜ï¸', clue:'Fluffy white things in the sky!' },
        { word:'GRASS', missing:3, emoji:'ğŸŒ±', clue:'Green stuff on the ground!' },
        { word:'LEAF',  missing:2, emoji:'ğŸƒ', clue:'It grows on trees!' },
      ]},
      { name: 'Level 7 â€“ Big World ğŸŒ', emoji: 'ğŸŒ', words: [
        { word:'SMILE',  missing:2, emoji:'ğŸ˜Š', clue:'What your face does when happy!' },
        { word:'HEART',  missing:2, emoji:'ğŸ’–', clue:'It means love!' },
        { word:'TIGER',  missing:2, emoji:'ğŸ¯', clue:'A stripy wild cat!' },
      ]},
      { name: 'Level 8 â€“ Magic Things âœ¨', emoji: 'âœ¨', words: [
        { word:'CROWN',  missing:3, emoji:'ğŸ‘‘', clue:'A princess wears this!' },
        { word:'FAIRY',  missing:2, emoji:'ğŸ§š', clue:'She has tiny wings and magic dust!' },
        { word:'MAGIC',  missing:1, emoji:'ğŸª„', clue:'A wizard\'s special power!' },
      ]},
      { name: 'Level 9 â€“ Bigger Words ğŸ¦‹', emoji: 'ğŸ¦‹', words: [
        { word:'TEDDY',  missing:3, emoji:'ğŸ§¸', clue:'A soft cuddly bear!' },
        { word:'BUNNY',  missing:3, emoji:'ğŸ°', clue:'Has long ears and hops!' },
        { word:'SUNNY',  missing:2, emoji:'â˜€ï¸', clue:'A bright and warm day!' },
      ]},
      { name: 'Level 10 â€“ Champion! ğŸ†', emoji: 'ğŸ†', words: [
        { word:'CASTLE',  missing:2, emoji:'ğŸ°', clue:'Where a princess lives!' },
        { word:'PRINCE',  missing:3, emoji:'ğŸ¤´', clue:'He wears a crown and cape!' },
        { word:'FLOWER',  missing:3, emoji:'ğŸŒ¸', clue:'Pretty and smells nice!' },
      ]},
    ];

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // HELPERS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function randInt(min, max){ return Math.floor(Math.random()*(max-min+1))+min; }

    function shuffle(arr){
      const a=[...arr];
      for(let i=a.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }

    // Generate 3 wrong letter choices (uppercase, no duplicates, not the answer)
    function buildLetterChoices(correct) {
      const alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const set = new Set([correct]);
      let tries = 0;
      while (set.size < 4 && tries < 200) {
        set.add(alpha[randInt(0, 25)]);
        tries++;
      }
      return shuffle([...set]);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // STATE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let levelIdx   = 0;
    let wordIdx    = 0;
    let totalStars = 0;
    let levelStars = 0;
    let answered   = false;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DOM
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const $ = id => document.getElementById(id);
    const wordHint    = $('word-hint');
    const wordClue    = $('word-clue');
    const wordDisplay = $('word-display');
    const choicesEl   = $('choices');
    const feedbackEl  = $('feedback');
    const nextBtn     = $('next-btn');
    const doorPanel   = $('door-panel');
    const starCount   = $('star-count');
    const journeyEl   = $('journey');
    const levelLabel  = $('level-label');
    const gameView    = $('game-view');
    const levelScreen = $('level-screen');
    const winScreen   = $('win-screen');

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // JOURNEY ROAD
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function buildJourney() {
      journeyEl.innerHTML = '';
      LEVELS.forEach((lv, i) => {
        const step = document.createElement('div');
        step.className = 'road-step';

        const dot = document.createElement('div');
        dot.className = 'road-dot' +
          (i < levelIdx ? ' done' : i === levelIdx ? ' active' : '');
        dot.textContent = i + 1;
        dot.title = lv.name;
        step.appendChild(dot);
        journeyEl.appendChild(step);

        if (i < LEVELS.length - 1) {
          const line = document.createElement('div');
          line.className = 'road-line';
          journeyEl.appendChild(line);
        }
      });

      // Unicorn at the end
      const uc = document.createElement('div');
      uc.className = 'road-line'; journeyEl.appendChild(uc);
      const uni = document.createElement('div');
      uni.className = 'road-unicorn' + (levelIdx >= LEVELS.length ? ' reached' : '');
      uni.textContent = 'ğŸ¦„';
      journeyEl.appendChild(uni);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // RENDER WORD
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function renderWord() {
      const level = LEVELS[levelIdx];
      const { word, missing, emoji, clue } = level.words[wordIdx];
      const correctLetter = word[missing];
      answered = false;

      wordHint.textContent = emoji;
      wordClue.textContent = clue;

      // Word boxes
      wordDisplay.innerHTML = '';
      [...word].forEach((ch, i) => {
        const box = document.createElement('div');
        box.className = 'letter-box' + (i === missing ? ' blank' : '');
        box.textContent = i === missing ? '' : ch;
        if (i === missing) box.id = 'blank-box';
        wordDisplay.appendChild(box);
      });

      // Door â€” closed
      doorPanel.classList.remove('open');
      doorPanel.textContent = 'ğŸ”’';

      // Letter choices
      choicesEl.innerHTML = '';
      buildLetterChoices(correctLetter).forEach(letter => {
        const btn = document.createElement('button');
        btn.className   = 'choice-btn';
        btn.textContent = letter;
        btn.addEventListener('click', () => handleChoice(btn, letter, correctLetter));
        choicesEl.appendChild(btn);
      });

      feedbackEl.textContent = '';
      feedbackEl.className   = '';
      nextBtn.style.display  = 'none';

      levelLabel.textContent =
        `${level.name}  Â·  Word ${wordIdx + 1} of ${level.words.length}`;

      buildJourney();
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // HANDLE CHOICE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function handleChoice(btn, chosen, correct) {
      if (answered) return;
      answered = true;

      document.querySelectorAll('.choice-btn').forEach(b => b.disabled = true);
      const blankBox = $('blank-box');

      if (chosen === correct) {
        btn.classList.add('correct');
        blankBox.textContent  = correct;
        blankBox.className    = 'letter-box correct-reveal';
        feedbackEl.textContent = ['Amazing! ğŸŒ¸', 'You got it! ğŸ’–', 'Brilliant! âœ¨', 'So smart! ğŸ¦„', 'Yay! ğŸ€'][randInt(0,4)];
        feedbackEl.className   = 'good';
        totalStars++; levelStars++;
        starCount.textContent  = totalStars;
        sndCorrect();
        // Open the door after short delay
        setTimeout(() => {
          doorPanel.classList.add('open');
          doorPanel.textContent = 'ğŸŒˆ';
          sndDoor();
        }, 400);
        nextBtn.style.display = 'inline-block';
        nextBtn.textContent   = wordIdx + 1 < LEVELS[levelIdx].words.length ? 'Next Word â¡ï¸' : 'Finish Level ğŸ€';
      } else {
        btn.classList.add('wrong');
        blankBox.classList.add('wrong-shake');
        setTimeout(() => blankBox.classList.remove('wrong-shake'), 450);
        feedbackEl.textContent = `Hmm, not quite! Try again ğŸ˜Š`;
        feedbackEl.className   = 'bad';
        sndWrong();
        // Re-enable after shake
        setTimeout(() => {
          document.querySelectorAll('.choice-btn').forEach(b => {
            b.disabled = false;
            b.classList.remove('wrong', 'correct');
          });
          btn.disabled = true; // disable the wrong one only
          answered = false;
          feedbackEl.textContent = '';
        }, 800);
      }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // NEXT
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    nextBtn.addEventListener('click', () => {
      wordIdx++;
      if (wordIdx >= LEVELS[levelIdx].words.length) {
        showLevelComplete();
      } else {
        renderWord();
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // LEVEL COMPLETE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function showLevelComplete() {
      sndLevelUp();
      gameView.style.display   = 'none';
      levelScreen.style.display = 'flex';

      const lv = LEVELS[levelIdx];
      $('lc-emoji').textContent = lv.emoji;
      $('lc-title').textContent = `${lv.name.split('â€“')[0].trim()} complete!`;
      const pct = Math.round((levelStars / lv.words.length) * 100);
      let msg = `You got ${levelStars} / ${lv.words.length} stars! `;
      if (levelStars === lv.words.length) msg += 'Perfect! ğŸŒˆğŸ€';
      else if (pct >= 66)                 msg += 'Really well done! ğŸŒ¸';
      else                                msg += 'Keep going â€” you\'re doing great! ğŸ’ª';
      $('lc-msg').textContent = msg;

      const isLast = levelIdx >= LEVELS.length - 1;
      $('next-level-btn').textContent = isLast ? 'ğŸ¦„ Find the Unicorn!' : 'Next Level â¡ï¸';
    }

    $('next-level-btn').addEventListener('click', () => {
      levelIdx++;
      levelStars = 0;
      wordIdx    = 0;
      levelScreen.style.display = 'none';

      if (levelIdx >= LEVELS.length) {
        showWin();
      } else {
        gameView.style.display = 'block';
        renderWord();
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // WIN
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function showWin() {
      sndWin();
      levelScreen.style.display = 'none';
      winScreen.style.display   = 'flex';
      const total = LEVELS.reduce((s,l) => s + l.words.length, 0);
      const pct   = Math.round((totalStars / total) * 100);
      let msg = `You got ${totalStars} out of ${total} stars! `;
      if (pct === 100)    msg += 'ğŸŒˆ Perfect score â€” you\'re a spelling superstar!';
      else if (pct >= 80) msg += 'ğŸ¦„ Amazing spelling skills!';
      else if (pct >= 60) msg += 'ğŸŒ¸ Great job â€” keep practising!';
      else                msg += 'ğŸ’– Well done for finishing â€” play again to get more stars!';
      $('win-msg').textContent = msg;

      // Animate unicorn on journey
      buildJourney();
    }

    $('play-again-btn').addEventListener('click', () => {
      levelIdx   = 0; wordIdx = 0;
      totalStars = 0; levelStars = 0;
      starCount.textContent = 0;
      winScreen.style.display  = 'none';
      gameView.style.display   = 'block';
      renderWord();
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // START
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    renderWord();
  </script>
</body>
</html>
